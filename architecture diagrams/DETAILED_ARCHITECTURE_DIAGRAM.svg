<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 1650" style="background: #ffffff;">
  <!-- Title -->
  <text x="1000" y="40" font-family="Arial, sans-serif" font-size="32" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Enterprise Application Architecture - Component View
  </text>
  <text x="1000" y="70" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" fill="#666">
    Component Architecture with Data Flow
  </text>

  <!-- Frontend Component -->
  <g id="frontend">
    <rect x="50" y="120" width="450" height="200" fill="#dbeafe" stroke="#3b82f6" stroke-width="4" rx="12"/>
    <text x="275" y="155" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#1e3a8a">Frontend Application</text>
    <text x="275" y="180" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Port: 3000</text>
    
    <line x1="70" y1="200" x2="480" y2="200" stroke="#3b82f6" stroke-width="2"/>
    
    <text x="70" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#1e3a8a">Components:</text>
    <text x="70" y="245" font-family="Arial" font-size="11" fill="#333">• Web UI (SPA/SSR)</text>
    <text x="70" y="260" font-family="Arial" font-size="11" fill="#333">• State Management</text>
    <text x="70" y="275" font-family="Arial" font-size="11" fill="#333">• API Client</text>
    <text x="70" y="290" font-family="Arial" font-size="11" fill="#333">• Token Management</text>
    
    <text x="250" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#1e3a8a">Features:</text>
    <text x="250" y="245" font-family="Arial" font-size="11" fill="#333">• Authentication UI</text>
    <text x="250" y="260" font-family="Arial" font-size="11" fill="#333">• Business Modules</text>
    <text x="250" y="275" font-family="Arial" font-size="11" fill="#333">• Reporting &amp; Analytics</text>
    <text x="250" y="290" font-family="Arial" font-size="11" fill="#333">• Field Masking</text>
  </g>

  <!-- API Gateway -->
  <g id="api-gateway">
    <rect x="550" y="120" width="350" height="200" fill="#cffafe" stroke="#06b6d4" stroke-width="4" rx="12"/>
    <text x="725" y="155" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#0e7490">API Gateway</text>
    <text x="725" y="180" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Request Router</text>
    
    <line x1="570" y1="200" x2="880" y2="200" stroke="#06b6d4" stroke-width="2"/>
    
    <text x="570" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#0e7490">Functions:</text>
    <text x="570" y="245" font-family="Arial" font-size="11" fill="#333">• Request Routing</text>
    <text x="570" y="260" font-family="Arial" font-size="11" fill="#333">• Load Balancing</text>
    <text x="570" y="275" font-family="Arial" font-size="11" fill="#333">• SSL/TLS Termination</text>
    <text x="570" y="290" font-family="Arial" font-size="11" fill="#333">• Rate Limiting</text>
    
    <text x="750" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#0e7490">Security:</text>
    <text x="750" y="245" font-family="Arial" font-size="11" fill="#333">• CORS Policy</text>
    <text x="750" y="260" font-family="Arial" font-size="11" fill="#333">• Request Validation</text>
    <text x="750" y="275" font-family="Arial" font-size="11" fill="#333">• Request Transformation</text>
  </g>

  <!-- Keycloak IAM -->
  <g id="keycloak">
    <rect x="950" y="120" width="500" height="200" fill="#fee2e2" stroke="#ef4444" stroke-width="4" rx="12"/>
    <text x="1200" y="155" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#991b1b">Keycloak IAM</text>
    <text x="1200" y="180" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Port: 8080</text>
    
    <line x1="970" y1="200" x2="1430" y2="200" stroke="#ef4444" stroke-width="2"/>
    
    <text x="970" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#991b1b">Authentication:</text>
    <text x="970" y="245" font-family="Arial" font-size="11" fill="#333">• Staff User Login</text>
    <text x="970" y="260" font-family="Arial" font-size="11" fill="#333">• JWT Token Issuance</text>
    <text x="970" y="275" font-family="Arial" font-size="11" fill="#333">• Token Validation</text>
    <text x="970" y="290" font-family="Arial" font-size="11" fill="#333">• Session Management</text>
    
    <text x="1200" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#991b1b">Authorization:</text>
    <text x="1200" y="245" font-family="Arial" font-size="11" fill="#333">• Role Management</text>
    <text x="1200" y="260" font-family="Arial" font-size="11" fill="#333">• Policy Engine</text>
    <text x="1200" y="275" font-family="Arial" font-size="11" fill="#333">• Permission Management</text>
    <text x="1200" y="290" font-family="Arial" font-size="11" fill="#333">• Feature Delegation</text>
    
    <text x="970" y="310" font-family="Arial" font-size="11" font-weight="bold" fill="#991b1b">Scope: Organization People (Staff/Admin) Only</text>
  </g>

  <!-- Backend Application -->
  <g id="backend">
    <rect x="1500" y="120" width="450" height="200" fill="#d1fae5" stroke="#10b981" stroke-width="4" rx="12"/>
    <text x="1725" y="155" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#065f46">Backend Application</text>
    <text x="1725" y="180" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Port: 8081</text>
    
    <line x1="1520" y1="200" x2="1930" y2="200" stroke="#10b981" stroke-width="2"/>
    
    <text x="1520" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#065f46">Services:</text>
    <text x="1520" y="245" font-family="Arial" font-size="11" fill="#333">• Business Logic</text>
    <text x="1520" y="260" font-family="Arial" font-size="11" fill="#333">• REST APIs</text>
    <text x="1520" y="275" font-family="Arial" font-size="11" fill="#333">• Transaction Management</text>
    <text x="1520" y="290" font-family="Arial" font-size="11" fill="#333">• Event Publishing</text>
    
    <text x="1700" y="225" font-family="Arial" font-size="12" font-weight="bold" fill="#065f46">Security:</text>
    <text x="1700" y="245" font-family="Arial" font-size="11" fill="#333">• JWT Validation</text>
    <text x="1700" y="260" font-family="Arial" font-size="11" fill="#333">• App-Level Auth</text>
    <text x="1700" y="275" font-family="Arial" font-size="11" fill="#333">• Field Masking</text>
    <text x="1700" y="290" font-family="Arial" font-size="11" fill="#333">• Authorization</text>
  </g>

  <!-- Database Component -->
  <g id="database">
    <rect x="50" y="380" width="1900" height="320" fill="#fed7aa" stroke="#f59e0b" stroke-width="4" rx="12"/>
    <text x="1000" y="420" font-family="Arial" font-size="24" font-weight="bold" text-anchor="middle" fill="#92400e">PostgreSQL Database</text>
    <text x="1000" y="450" font-family="Arial" font-size="14" text-anchor="middle" fill="#666">Port: 5432 | Dual Schema Architecture</text>
    
    <line x1="100" y1="480" x2="1900" y2="480" stroke="#f59e0b" stroke-width="3"/>
    
    <!-- Keycloak Schema -->
    <rect x="100" y="500" width="900" height="180" fill="#fde68a" stroke="#f59e0b" stroke-width="3" rx="10"/>
    <text x="550" y="535" font-family="Arial" font-size="20" font-weight="bold" text-anchor="middle" fill="#92400e">Keycloak Schema</text>
    <text x="550" y="560" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Organization People, Authentication &amp; Authorization</text>
    <text x="550" y="580" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#991b1b">Manages Internal Staff Users Only</text>
    
    <line x1="130" y1="600" x2="870" y2="600" stroke="#f59e0b" stroke-width="2"/>
    
    <rect x="130" y="620" width="200" height="50" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="5"/>
    <text x="230" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">Organization</text>
    <text x="130" y="660" font-family="Arial" font-size="11" fill="#333">Organization structure,</text>
    <text x="130" y="675" font-family="Arial" font-size="11" fill="#333">departments, hierarchy</text>
    
    <rect x="350" y="620" width="200" height="50" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="5"/>
    <text x="450" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">People</text>
    <text x="350" y="660" font-family="Arial" font-size="11" fill="#333">Staff user accounts,</text>
    <text x="350" y="675" font-family="Arial" font-size="11" fill="#333">profiles, attributes</text>
    
    <rect x="570" y="620" width="160" height="50" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="5"/>
    <text x="650" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">Authentication</text>
    <text x="570" y="660" font-family="Arial" font-size="11" fill="#333">Credentials,</text>
    <text x="570" y="675" font-family="Arial" font-size="11" fill="#333">sessions</text>
    
    <rect x="750" y="620" width="150" height="50" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="5"/>
    <text x="825" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#92400e">Authorization</text>
    <text x="750" y="660" font-family="Arial" font-size="11" fill="#333">Roles, policies,</text>
    <text x="750" y="675" font-family="Arial" font-size="11" fill="#333">permissions</text>
    
    <!-- Application Schema -->
    <rect x="1050" y="500" width="900" height="180" fill="#d1fae5" stroke="#10b981" stroke-width="3" rx="10"/>
    <text x="1500" y="535" font-family="Arial" font-size="20" font-weight="bold" text-anchor="middle" fill="#065f46">Application Schema</text>
    <text x="1500" y="560" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Business Data &amp; Application Entities</text>
    <text x="1500" y="580" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#991b1b">Manages Recipients &amp; Providers at Application Level</text>
    
    <line x1="1080" y1="600" x2="1920" y2="600" stroke="#10b981" stroke-width="2"/>
    
    <rect x="1080" y="620" width="200" height="50" fill="#a7f3d0" stroke="#10b981" stroke-width="2" rx="5"/>
    <text x="1180" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#065f46">Recipients</text>
    <text x="1080" y="660" font-family="Arial" font-size="11" fill="#333">Recipient data,</text>
    <text x="1080" y="675" font-family="Arial" font-size="11" fill="#333">profiles, cases</text>
    
    <rect x="1300" y="620" width="200" height="50" fill="#a7f3d0" stroke="#10b981" stroke-width="2" rx="5"/>
    <text x="1400" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#065f46">Providers</text>
    <text x="1300" y="660" font-family="Arial" font-size="11" fill="#333">Provider data,</text>
    <text x="1300" y="675" font-family="Arial" font-size="11" fill="#333">licenses, services</text>
    
    <rect x="1520" y="620" width="200" height="50" fill="#a7f3d0" stroke="#10b981" stroke-width="2" rx="5"/>
    <text x="1620" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#065f46">App Authentication</text>
    <text x="1520" y="660" font-family="Arial" font-size="11" fill="#333">Recipient/Provider</text>
    <text x="1520" y="675" font-family="Arial" font-size="11" fill="#333">credentials &amp; sessions</text>
    
    <rect x="1740" y="620" width="160" height="50" fill="#a7f3d0" stroke="#10b981" stroke-width="2" rx="5"/>
    <text x="1820" y="640" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#065f46">Business Data</text>
    <text x="1740" y="660" font-family="Arial" font-size="11" fill="#333">Timesheets, tasks,</text>
    <text x="1740" y="675" font-family="Arial" font-size="11" fill="#333">cases, reports</text>
  </g>

  <!-- Kafka Component -->
  <g id="kafka">
    <rect x="50" y="750" width="500" height="200" fill="#fce7f3" stroke="#ec4899" stroke-width="4" rx="12"/>
    <text x="300" y="785" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#9f1239">Apache Kafka</text>
    <text x="300" y="810" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Port: 9092</text>
    
    <line x1="70" y1="830" x2="530" y2="830" stroke="#ec4899" stroke-width="2"/>
    
    <text x="70" y="855" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239">Function:</text>
    <text x="70" y="875" font-family="Arial" font-size="11" fill="#333">• Message Broker</text>
    <text x="70" y="890" font-family="Arial" font-size="11" fill="#333">• Event Streaming</text>
    <text x="70" y="905" font-family="Arial" font-size="11" fill="#333">• Async Processing</text>
    <text x="70" y="920" font-family="Arial" font-size="11" fill="#333">• Event Persistence</text>
    
    <text x="250" y="855" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239">Topics:</text>
    <text x="250" y="875" font-family="Arial" font-size="11" fill="#333">• Case Events</text>
    <text x="250" y="890" font-family="Arial" font-size="11" fill="#333">• Timesheet Events</text>
    <text x="250" y="905" font-family="Arial" font-size="11" fill="#333">• Task Events</text>
    <text x="250" y="920" font-family="Arial" font-size="11" fill="#333">• Notification Events</text>
    
    <text x="400" y="855" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239">Consumers:</text>
    <text x="400" y="875" font-family="Arial" font-size="11" fill="#333">• Event Processors</text>
    <text x="400" y="890" font-family="Arial" font-size="11" fill="#333">• Task Creators</text>
    <text x="400" y="905" font-family="Arial" font-size="11" fill="#333">• Notification Generators</text>
    <text x="400" y="920" font-family="Arial" font-size="11" fill="#333">• Report Processors</text>
  </g>

  <!-- Zookeeper -->
  <g id="zookeeper">
    <rect x="600" y="750" width="300" height="200" fill="#e0e7ff" stroke="#6366f1" stroke-width="3" rx="12"/>
    <text x="750" y="785" font-family="Arial" font-size="20" font-weight="bold" text-anchor="middle" fill="#4338ca">Zookeeper</text>
    <text x="750" y="810" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">Port: 2181</text>
    
    <line x1="620" y1="830" x2="880" y2="830" stroke="#6366f1" stroke-width="2"/>
    
    <text x="620" y="855" font-family="Arial" font-size="12" font-weight="bold" fill="#4338ca">Function:</text>
    <text x="620" y="875" font-family="Arial" font-size="11" fill="#333">• Cluster Coordination</text>
    <text x="620" y="890" font-family="Arial" font-size="11" fill="#333">• Leader Election</text>
    <text x="620" y="905" font-family="Arial" font-size="11" fill="#333">• Configuration Management</text>
    <text x="620" y="920" font-family="Arial" font-size="11" fill="#333">• Service Discovery</text>
    <text x="620" y="935" font-family="Arial" font-size="11" fill="#333">• Metadata Storage</text>
  </g>

  <!-- Cache Layer -->
  <g id="cache">
    <rect x="950" y="750" width="400" height="200" fill="#e5e7eb" stroke="#6b7280" stroke-width="3" rx="12"/>
    <text x="1150" y="785" font-family="Arial" font-size="20" font-weight="bold" text-anchor="middle" fill="#374151">Cache Layer</text>
    <text x="1150" y="810" font-family="Arial" font-size="13" text-anchor="middle" fill="#666">In-Memory Caching</text>
    
    <line x1="970" y1="830" x2="1330" y2="830" stroke="#6b7280" stroke-width="2"/>
    
    <text x="970" y="855" font-family="Arial" font-size="12" font-weight="bold" fill="#374151">Cache Types:</text>
    <text x="970" y="875" font-family="Arial" font-size="11" fill="#333">• Session Cache</text>
    <text x="970" y="890" font-family="Arial" font-size="11" fill="#333">• Token Cache</text>
    <text x="970" y="905" font-family="Arial" font-size="11" fill="#333">• Data Cache</text>
    <text x="970" y="920" font-family="Arial" font-size="11" fill="#333">• Query Result Cache</text>
    
    <text x="1150" y="855" font-family="Arial" font-size="12" font-weight="bold" fill="#374151">Benefits:</text>
    <text x="1150" y="875" font-family="Arial" font-size="11" fill="#333">• Reduced DB Load</text>
    <text x="1150" y="890" font-family="Arial" font-size="11" fill="#333">• Faster Response</text>
    <text x="1150" y="905" font-family="Arial" font-size="11" fill="#333">• Improved Performance</text>
  </g>

  <!-- Data Flow Arrows -->
  <!-- Frontend to API Gateway -->
  <line x1="500" y1="220" x2="550" y2="220" stroke="#06b6d4" stroke-width="5" marker-end="url(#arrowhead-blue)"/>
  <text x="520" y="210" font-family="Arial" font-size="11" font-weight="bold" fill="#0e7490">HTTP/HTTPS</text>
  
  <!-- API Gateway to Backend -->
  <line x1="900" y1="220" x2="1500" y2="220" stroke="#10b981" stroke-width="5" marker-end="url(#arrowhead-green)"/>
  <text x="1200" y="210" font-family="Arial" font-size="11" font-weight="bold" fill="#065f46">API Requests</text>
  
  <!-- Frontend to Keycloak (Authentication) -->
  <line x1="500" y1="270" x2="950" y2="270" stroke="#ef4444" stroke-width="5" stroke-dasharray="8,4" marker-end="url(#arrowhead-red)"/>
  <text x="720" y="260" font-family="Arial" font-size="11" font-weight="bold" fill="#991b1b">Staff Login</text>
  
  <!-- Keycloak to Frontend (Token) -->
  <line x1="950" y1="300" x2="500" y2="300" stroke="#ef4444" stroke-width="5" stroke-dasharray="8,4" marker-end="url(#arrowhead-red)"/>
  <text x="720" y="310" font-family="Arial" font-size="11" font-weight="bold" fill="#991b1b">JWT Token</text>
  
  <!-- Backend to Keycloak (Token Validation) -->
  <line x1="1500" y1="270" x2="1450" y2="270" stroke="#ef4444" stroke-width="5" stroke-dasharray="8,4" marker-end="url(#arrowhead-red)"/>
  <text x="1470" y="260" font-family="Arial" font-size="11" font-weight="bold" fill="#991b1b">Validate Token</text>
  
  <!-- Keycloak to Backend (Validation Response) -->
  <line x1="1450" y1="300" x2="1500" y2="300" stroke="#ef4444" stroke-width="5" stroke-dasharray="8,4" marker-end="url(#arrowhead-red)"/>
  <text x="1470" y="310" font-family="Arial" font-size="11" font-weight="bold" fill="#991b1b">User Info</text>
  
  <!-- Backend to Database - Keycloak Schema -->
  <line x1="1725" y1="320" x2="550" y2="500" stroke="#f59e0b" stroke-width="5" marker-end="url(#arrowhead-orange)"/>
  <text x="1130" y="410" font-family="Arial" font-size="11" font-weight="bold" fill="#92400e">Read IAM Data</text>
  
  <!-- Keycloak to Database - Keycloak Schema -->
  <line x1="1200" y1="320" x2="550" y2="500" stroke="#ef4444" stroke-width="5" stroke-dasharray="8,4" marker-end="url(#arrowhead-red)"/>
  <text x="870" y="410" font-family="Arial" font-size="11" font-weight="bold" fill="#991b1b">IAM Operations</text>
  
  <!-- Backend to Database - Application Schema -->
  <line x1="1725" y1="320" x2="1500" y2="500" stroke="#10b981" stroke-width="5" marker-end="url(#arrowhead-green)"/>
  <text x="1610" y="410" font-family="Arial" font-size="11" font-weight="bold" fill="#065f46">Business Data</text>
  
  <!-- Backend to Kafka (Publish Events) -->
  <line x1="1500" y1="320" x2="300" y2="750" stroke="#ec4899" stroke-width="5" marker-end="url(#arrowhead-pink)"/>
  <text x="900" y="535" font-family="Arial" font-size="11" font-weight="bold" fill="#9f1239">Publish Events</text>
  
  <!-- Kafka to Backend (Consume Events) -->
  <line x1="550" y1="850" x2="1500" y2="320" stroke="#ec4899" stroke-width="5" stroke-dasharray="5,5" marker-end="url(#arrowhead-pink)"/>
  <text x="1025" y="585" font-family="Arial" font-size="11" font-weight="bold" fill="#9f1239">Process Events</text>
  
  <!-- Kafka to Zookeeper -->
  <line x1="550" y1="850" x2="600" y2="850" stroke="#6366f1" stroke-width="3" stroke-dasharray="3,3"/>
  <text x="570" y="840" font-family="Arial" font-size="10" fill="#4338ca">Coordination</text>
  
  <!-- Backend to Cache -->
  <line x1="1950" y1="220" x2="1350" y2="750" stroke="#6b7280" stroke-width="4" stroke-dasharray="5,5" marker-end="url(#arrowhead-grey)"/>
  <text x="1650" y="485" font-family="Arial" font-size="11" font-weight="bold" fill="#374151">Cache Access</text>
  
  <!-- Cache to Backend -->
  <line x1="1150" y1="950" x2="1950" y2="220" stroke="#6b7280" stroke-width="4" stroke-dasharray="5,5" marker-end="url(#arrowhead-grey)"/>
  <text x="1550" y="585" font-family="Arial" font-size="11" font-weight="bold" fill="#374151">Cached Data</text>

  <!-- Arrow Markers -->
  <defs>
    <marker id="arrowhead-blue" markerWidth="14" markerHeight="14" refX="13" refY="7" orient="auto">
      <polygon points="0 0, 14 7, 0 14" fill="#06b6d4"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="14" markerHeight="14" refX="13" refY="7" orient="auto">
      <polygon points="0 0, 14 7, 0 14" fill="#10b981"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="14" markerHeight="14" refX="13" refY="7" orient="auto">
      <polygon points="0 0, 14 7, 0 14" fill="#ef4444"/>
    </marker>
    <marker id="arrowhead-orange" markerWidth="14" markerHeight="14" refX="13" refY="7" orient="auto">
      <polygon points="0 0, 14 7, 0 14" fill="#f59e0b"/>
    </marker>
    <marker id="arrowhead-pink" markerWidth="14" markerHeight="14" refX="13" refY="7" orient="auto">
      <polygon points="0 0, 14 7, 0 14" fill="#ec4899"/>
    </marker>
    <marker id="arrowhead-grey" markerWidth="14" markerHeight="14" refX="13" refY="7" orient="auto">
      <polygon points="0 0, 14 7, 0 14" fill="#6b7280"/>
    </marker>
  </defs>

  <!-- Component Summary -->
  <g id="summary">
    <rect x="50" y="1000" width="1900" height="360" fill="#f9fafb" stroke="#9ca3af" stroke-width="2" rx="10"/>
    <text x="1000" y="1035" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#374151">Component Overview &amp; Data Flow</text>
    
    <line x1="100" y1="1055" x2="1900" y2="1055" stroke="#9ca3af" stroke-width="1"/>
    
    <!-- Frontend -->
    <rect x="100" y="1075" width="400" height="260" fill="white" stroke="#3b82f6" stroke-width="2" rx="5"/>
    <text x="300" y="1105" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#1e3a8a">Frontend Application</text>
    <text x="120" y="1130" font-family="Arial" font-size="12" font-weight="bold" fill="#1e3a8a">Purpose:</text>
    <text x="120" y="1148" font-family="Arial" font-size="11" fill="#333">Single unified web application providing</text>
    <text x="120" y="1163" font-family="Arial" font-size="11" fill="#333">user interface for all business functions</text>
    <text x="120" y="1185" font-family="Arial" font-size="12" font-weight="bold" fill="#1e3a8a">Connections:</text>
    <text x="120" y="1203" font-family="Arial" font-size="11" fill="#333">→ API Gateway (API requests)</text>
    <text x="120" y="1218" font-family="Arial" font-size="11" fill="#333">→ Keycloak (Staff authentication)</text>
    <text x="120" y="1233" font-family="Arial" font-size="11" fill="#333">← Receives JWT tokens</text>
    <text x="120" y="1250" font-family="Arial" font-size="12" font-weight="bold" fill="#1e3a8a">Contains:</text>
    <text x="120" y="1268" font-family="Arial" font-size="11" fill="#333">• UI components, state management</text>
    <text x="120" y="1283" font-family="Arial" font-size="11" fill="#333">• API client, token management</text>
    <text x="120" y="1298" font-family="Arial" font-size="11" fill="#333">• Field masking, i18n support</text>
    
    <!-- API Gateway -->
    <rect x="550" y="1075" width="350" height="260" fill="white" stroke="#06b6d4" stroke-width="2" rx="5"/>
    <text x="725" y="1105" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#0e7490">API Gateway</text>
    <text x="570" y="1130" font-family="Arial" font-size="12" font-weight="bold" fill="#0e7490">Purpose:</text>
    <text x="570" y="1148" font-family="Arial" font-size="11" fill="#333">Single entry point for all API requests,</text>
    <text x="570" y="1163" font-family="Arial" font-size="11" fill="#333">handles routing and security</text>
    <text x="570" y="1185" font-family="Arial" font-size="12" font-weight="bold" fill="#0e7490">Connections:</text>
    <text x="570" y="1203" font-family="Arial" font-size="11" fill="#333">← Frontend (receives requests)</text>
    <text x="570" y="1218" font-family="Arial" font-size="11" fill="#333">→ Backend (routes requests)</text>
    <text x="570" y="1233" font-family="Arial" font-size="11" fill="#333">← Backend (receives responses)</text>
    <text x="570" y="1250" font-family="Arial" font-size="12" font-weight="bold" fill="#0e7490">Contains:</text>
    <text x="570" y="1268" font-family="Arial" font-size="11" fill="#333">• Request routing, load balancing</text>
    <text x="570" y="1283" font-family="Arial" font-size="11" fill="#333">• SSL/TLS termination, rate limiting</text>
    <text x="570" y="1298" font-family="Arial" font-size="11" fill="#333">• CORS, request transformation</text>
    
    <!-- Keycloak -->
    <rect x="950" y="1075" width="400" height="260" fill="white" stroke="#ef4444" stroke-width="2" rx="5"/>
    <text x="1150" y="1105" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#991b1b">Keycloak IAM</text>
    <text x="970" y="1130" font-family="Arial" font-size="12" font-weight="bold" fill="#991b1b">Purpose:</text>
    <text x="970" y="1148" font-family="Arial" font-size="11" fill="#333">Manages authentication &amp; authorization</text>
    <text x="970" y="1163" font-family="Arial" font-size="11" fill="#333">for Organization People (Staff/Admin) ONLY</text>
    <text x="970" y="1185" font-family="Arial" font-size="12" font-weight="bold" fill="#991b1b">Connections:</text>
    <text x="970" y="1203" font-family="Arial" font-size="11" fill="#333">← Frontend (login requests)</text>
    <text x="970" y="1218" font-family="Arial" font-size="11" fill="#333">→ Frontend (JWT tokens)</text>
    <text x="970" y="1233" font-family="Arial" font-size="11" fill="#333">← Backend (token validation)</text>
    <text x="970" y="1248" font-family="Arial" font-size="11" fill="#333">→ Backend (user info)</text>
    <text x="970" y="1263" font-family="Arial" font-size="11" fill="#333">→ Keycloak Schema (IAM data)</text>
    <text x="970" y="1280" font-family="Arial" font-size="12" font-weight="bold" fill="#991b1b">Contains:</text>
    <text x="970" y="1298" font-family="Arial" font-size="11" fill="#333">• Authentication service, JWT issuance</text>
    <text x="970" y="1313" font-family="Arial" font-size="11" fill="#333">• Role/permission management, policy engine</text>
    
    <!-- Backend -->
    <rect x="1400" y="1075" width="400" height="260" fill="white" stroke="#10b981" stroke-width="2" rx="5"/>
    <text x="1600" y="1105" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#065f46">Backend Application</text>
    <text x="1420" y="1130" font-family="Arial" font-size="12" font-weight="bold" fill="#065f46">Purpose:</text>
    <text x="1420" y="1148" font-family="Arial" font-size="11" fill="#333">Implements business logic, provides REST APIs,</text>
    <text x="1420" y="1163" font-family="Arial" font-size="11" fill="#333">handles application-level auth for Recipients/Providers</text>
    <text x="1420" y="1185" font-family="Arial" font-size="12" font-weight="bold" fill="#065f46">Connections:</text>
    <text x="1420" y="1203" font-family="Arial" font-size="11" fill="#333">← API Gateway (API requests)</text>
    <text x="1420" y="1218" font-family="Arial" font-size="11" fill="#333">→ Keycloak (token validation)</text>
    <text x="1420" y="1233" font-family="Arial" font-size="11" fill="#333">→ Database (both schemas)</text>
    <text x="1420" y="1248" font-family="Arial" font-size="11" fill="#333">→ Kafka (publish events)</text>
    <text x="1420" y="1263" font-family="Arial" font-size="11" fill="#333">← Kafka (consume events)</text>
    <text x="1420" y="1278" font-family="Arial" font-size="11" fill="#333">→ Cache (read/write)</text>
    <text x="1420" y="1295" font-family="Arial" font-size="12" font-weight="bold" fill="#065f46">Contains:</text>
    <text x="1420" y="1313" font-family="Arial" font-size="11" fill="#333">• Business services, REST APIs, security layer</text>
    
    <!-- Database -->
    <rect x="100" y="1380" width="550" height="180" fill="white" stroke="#f59e0b" stroke-width="2" rx="5"/>
    <text x="375" y="1410" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#92400e">PostgreSQL Database</text>
    <text x="120" y="1435" font-family="Arial" font-size="12" font-weight="bold" fill="#92400e">Purpose:</text>
    <text x="120" y="1453" font-family="Arial" font-size="11" fill="#333">Dual schema architecture for data persistence</text>
    <text x="120" y="1470" font-family="Arial" font-size="12" font-weight="bold" fill="#92400e">Keycloak Schema:</text>
    <text x="120" y="1488" font-family="Arial" font-size="11" fill="#333">Organization, People (Staff), Authentication, Authorization</text>
    <text x="120" y="1505" font-family="Arial" font-size="12" font-weight="bold" fill="#92400e">Application Schema:</text>
    <text x="120" y="1523" font-family="Arial" font-size="11" fill="#333">Recipients, Providers, Business Data, App-Level Auth</text>
    <text x="120" y="1540" font-family="Arial" font-size="12" font-weight="bold" fill="#92400e">Connections:</text>
    <text x="120" y="1558" font-family="Arial" font-size="11" fill="#333">← Keycloak (IAM operations)</text>
    <text x="120" y="1573" font-family="Arial" font-size="11" fill="#333">← Backend (data access)</text>
    
    <!-- Kafka -->
    <rect x="700" y="1380" width="500" height="180" fill="white" stroke="#ec4899" stroke-width="2" rx="5"/>
    <text x="950" y="1410" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#9f1239">Apache Kafka</text>
    <text x="720" y="1435" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239">Purpose:</text>
    <text x="720" y="1453" font-family="Arial" font-size="11" fill="#333">Event-driven messaging for async processing</text>
    <text x="720" y="1470" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239">Connections:</text>
    <text x="720" y="1488" font-family="Arial" font-size="11" fill="#333">← Backend (receives events)</text>
    <text x="720" y="1505" font-family="Arial" font-size="11" fill="#333">→ Backend Consumers (distributes events)</text>
    <text x="720" y="1523" font-family="Arial" font-size="11" fill="#333">→ Zookeeper (coordination)</text>
    <text x="720" y="1540" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239">Contains:</text>
    <text x="720" y="1558" font-family="Arial" font-size="11" fill="#333">• Event topics, consumer groups, message persistence</text>
    
    <!-- Cache -->
    <rect x="1250" y="1380" width="400" height="180" fill="white" stroke="#6b7280" stroke-width="2" rx="5"/>
    <text x="1450" y="1410" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#374151">Cache Layer</text>
    <text x="1270" y="1435" font-family="Arial" font-size="12" font-weight="bold" fill="#374151">Purpose:</text>
    <text x="1270" y="1453" font-family="Arial" font-size="11" fill="#333">In-memory caching for performance optimization</text>
    <text x="1270" y="1470" font-family="Arial" font-size="12" font-weight="bold" fill="#374151">Connections:</text>
    <text x="1270" y="1488" font-family="Arial" font-size="11" fill="#333">← Backend (cache writes)</text>
    <text x="1270" y="1505" font-family="Arial" font-size="11" fill="#333">→ Backend (cache reads)</text>
    <text x="1270" y="1523" font-family="Arial" font-size="12" font-weight="bold" fill="#374151">Contains:</text>
    <text x="1270" y="1541" font-family="Arial" font-size="11" fill="#333">• Session, token, data, query result caches</text>
    
    <!-- Zookeeper -->
    <rect x="1700" y="1380" width="250" height="180" fill="white" stroke="#6366f1" stroke-width="2" rx="5"/>
    <text x="1825" y="1410" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle" fill="#4338ca">Zookeeper</text>
    <text x="1720" y="1435" font-family="Arial" font-size="12" font-weight="bold" fill="#4338ca">Purpose:</text>
    <text x="1720" y="1453" font-family="Arial" font-size="11" fill="#333">Kafka cluster coordination</text>
    <text x="1720" y="1470" font-family="Arial" font-size="12" font-weight="bold" fill="#4338ca">Connections:</text>
    <text x="1720" y="1488" font-family="Arial" font-size="11" fill="#333">← Kafka (coordination)</text>
    <text x="1720" y="1505" font-family="Arial" font-size="12" font-weight="bold" fill="#4338ca">Contains:</text>
    <text x="1720" y="1523" font-family="Arial" font-size="11" fill="#333">• Cluster metadata, configuration,</text>
    <text x="1720" y="1541" font-family="Arial" font-size="11" fill="#333">leader election</text>
  </g>

  <!-- Key Design Decision -->
  <g id="design-decision">
    <rect x="50" y="1600" width="1900" height="30" fill="#fef2f2" stroke="#dc2626" stroke-width="3" rx="5"/>
    <text x="1000" y="1620" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#991b1b">
      KEY DESIGN: Keycloak manages Organization People (Staff/Admin) only. Recipients &amp; Providers use Application-Level Authentication due to high volume.
    </text>
  </g>
</svg>
