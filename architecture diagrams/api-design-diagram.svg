<svg width="1800" height="2600" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="900" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    CMIPS API Design - Address Change Scenario
  </text>
  <text x="900" y="55" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#666">
    RESTful API Architecture &amp; Data Flow
  </text>
  
  <!-- API Gateway / Load Balancer -->
  <rect x="50" y="80" width="1700" height="2480" fill="#f0f8ff" stroke="#1e3a8a" stroke-width="2" rx="10"/>
  
  <rect x="100" y="110" width="1600" height="80" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" rx="5"/>
  <text x="900" y="135" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2e7d32">
    Application Load Balancer / API Gateway
  </text>
  <text x="900" y="155" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">
    Base URL: https://api.cmips.example.com | SSL Termination | Rate Limiting | CORS Headers
  </text>
  <text x="900" y="175" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#333">
    Health Check: GET /actuator/health | Authentication: JWT Bearer Token
  </text>
  
  <!-- Authentication API -->
  <text x="900" y="230" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Authentication API
  </text>
  
  <rect x="100" y="250" width="1600" height="180" fill="#fff3e0" stroke="#e65100" stroke-width="2" rx="5"/>
  <text x="900" y="275" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#e65100">
    POST /api/auth/login
  </text>
  
  <rect x="120" y="290" width="1560" height="130" fill="#ffffff" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="140" y="310" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#e65100">Request Body:</text>
  <text x="140" y="330" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="160" y="345" font-family="Arial, sans-serif" font-size="9" fill="#333">"username": "provider1",</text>
  <text x="160" y="360" font-family="Arial, sans-serif" font-size="9" fill="#333">"password": "password123"</text>
  <text x="140" y="375" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="800" y="310" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#e65100">Response 200 OK:</text>
  <text x="800" y="330" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="820" y="345" font-family="Arial, sans-serif" font-size="9" fill="#333">"success": true,</text>
  <text x="820" y="360" font-family="Arial, sans-serif" font-size="9" fill="#333">"token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",</text>
  <text x="820" y="375" font-family="Arial, sans-serif" font-size="9" fill="#333">"refreshToken": "refresh_token_here",</text>
  <text x="820" y="390" font-family="Arial, sans-serif" font-size="9" fill="#333">"user": {</text>
  <text x="840" y="405" font-family="Arial, sans-serif" font-size="9" fill="#333">"id": "provider1",</text>
  <text x="840" y="420" font-family="Arial, sans-serif" font-size="9" fill="#333">"username": "provider1",</text>
  <text x="840" y="435" font-family="Arial, sans-serif" font-size="9" fill="#333">"role": "PROVIDER",</text>
  <text x="840" y="450" font-family="Arial, sans-serif" font-size="9" fill="#333">"roles": ["PROVIDER"]</text>
  <text x="820" y="465" font-family="Arial, sans-serif" font-size="9" fill="#333">},</text>
  <text x="820" y="480" font-family="Arial, sans-serif" font-size="9" fill="#333">"expiresIn": 3600</text>
  <text x="800" y="495" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="1400" y="310" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#e65100">Response 401 Unauthorized:</text>
  <text x="1400" y="330" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="1420" y="345" font-family="Arial, sans-serif" font-size="9" fill="#333">"success": false,</text>
  <text x="1420" y="360" font-family="Arial, sans-serif" font-size="9" fill="#333">"error": "Invalid credentials"</text>
  <text x="1400" y="375" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <!-- Address Change API -->
  <text x="900" y="480" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Address Change API - Main Scenario
  </text>
  
  <rect x="100" y="500" width="1600" height="280" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5"/>
  <text x="900" y="525" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#1976d2">
    POST /api/cases/address-change
  </text>
  <text x="900" y="545" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Content-Type: application/json | Role Required: PROVIDER
  </text>
  
  <rect x="120" y="560" width="1560" height="210" fill="#ffffff" stroke="#1976d2" stroke-width="1" rx="3"/>
  <text x="140" y="580" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1976d2">Request Headers:</text>
  <text x="140" y="595" font-family="Arial, sans-serif" font-size="9" fill="#333">Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...</text>
  <text x="140" y="610" font-family="Arial, sans-serif" font-size="9" fill="#333">Content-Type: application/json</text>
  <text x="140" y="625" font-family="Arial, sans-serif" font-size="9" fill="#333">X-Request-ID: req-uuid-123</text>
  
  <text x="140" y="650" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1976d2">Request Body:</text>
  <text x="140" y="670" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="160" y="685" font-family="Arial, sans-serif" font-size="9" fill="#333">"caseId": "CASE-001",</text>
  <text x="160" y="700" font-family="Arial, sans-serif" font-size="9" fill="#333">"recipientId": "recipient1",</text>
  <text x="160" y="715" font-family="Arial, sans-serif" font-size="9" fill="#333">"recipientName": "recipient1",</text>
  <text x="160" y="730" font-family="Arial, sans-serif" font-size="9" fill="#333">"providerId": "provider1",</text>
  <text x="160" y="745" font-family="Arial, sans-serif" font-size="9" fill="#333">"newAddress": {</text>
  <text x="180" y="760" font-family="Arial, sans-serif" font-size="9" fill="#333">"line1": "123 Main Street",</text>
  <text x="180" y="775" font-family="Arial, sans-serif" font-size="9" fill="#333">"city": "Las Vegas",</text>
  <text x="180" y="790" font-family="Arial, sans-serif" font-size="9" fill="#333">"state": "NV",</text>
  <text x="180" y="805" font-family="Arial, sans-serif" font-size="9" fill="#333">"zip": "89101"</text>
  <text x="160" y="820" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="140" y="835" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="800" y="580" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1976d2">Response 200 OK:</text>
  <text x="800" y="600" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="820" y="615" font-family="Arial, sans-serif" font-size="9" fill="#333">"message": "Address change submitted successfully",</text>
  <text x="820" y="630" font-family="Arial, sans-serif" font-size="9" fill="#333">"caseId": "CASE-001",</text>
  <text x="820" y="645" font-family="Arial, sans-serif" font-size="9" fill="#333">"willCreateTask": "true"</text>
  <text x="800" y="660" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="800" y="690" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1976d2">Response 400 Bad Request:</text>
  <text x="800" y="710" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="820" y="725" font-family="Arial, sans-serif" font-size="9" fill="#333">"error": "Invalid address format",</text>
  <text x="820" y="740" font-family="Arial, sans-serif" font-size="9" fill="#333">"details": {</text>
  <text x="840" y="755" font-family="Arial, sans-serif" font-size="9" fill="#333">"field": "newAddress.state",</text>
  <text x="840" y="770" font-family="Arial, sans-serif" font-size="9" fill="#333">"message": "State is required"</text>
  <text x="820" y="785" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="800" y="800" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="1400" y="580" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1976d2">Response 401 Unauthorized:</text>
  <text x="1400" y="600" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="1420" y="615" font-family="Arial, sans-serif" font-size="9" fill="#333">"error": "Unauthorized",</text>
  <text x="1420" y="630" font-family="Arial, sans-serif" font-size="9" fill="#333">"message": "Invalid or expired token"</text>
  <text x="1400" y="645" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="1400" y="675" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1976d2">Response 403 Forbidden:</text>
  <text x="1400" y="695" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="1420" y="710" font-family="Arial, sans-serif" font-size="9" fill="#333">"error": "Forbidden",</text>
  <text x="1420" y="725" font-family="Arial, sans-serif" font-size="9" fill="#333">"message": "Insufficient permissions. Role PROVIDER required."</text>
  <text x="1400" y="740" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <!-- Notification API -->
  <text x="900" y="840" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Notification API
  </text>
  
  <rect x="100" y="860" width="750" height="200" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="5"/>
  <text x="475" y="885" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#7b1fa2">
    GET /api/notifications/user/{userId}
  </text>
  <text x="475" y="905" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: Any authenticated user
  </text>
  
  <rect x="120" y="920" width="710" height="130" fill="#ffffff" stroke="#7b1fa2" stroke-width="1" rx="3"/>
  <text x="140" y="940" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#7b1fa2">Response 200 OK:</text>
  <text x="140" y="960" font-family="Arial, sans-serif" font-size="9" fill="#333">[</text>
  <text x="160" y="975" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="180" y="990" font-family="Arial, sans-serif" font-size="9" fill="#333">"id": 456,</text>
  <text x="180" y="1005" font-family="Arial, sans-serif" font-size="9" fill="#333">"userId": "recipient1",</text>
  <text x="180" y="1020" font-family="Arial, sans-serif" font-size="9" fill="#333">"message": "Your care giver provider1 has changed their address to 123 Main Street, Las Vegas, NV 89101",</text>
  <text x="180" y="1035" font-family="Arial, sans-serif" font-size="9" fill="#333">"notificationType": "INFO",</text>
  <text x="180" y="1050" font-family="Arial, sans-serif" font-size="9" fill="#333">"readStatus": false,</text>
  <text x="180" y="1065" font-family="Arial, sans-serif" font-size="9" fill="#333">"actionLink": "/recipient/dashboard",</text>
  <text x="180" y="1080" font-family="Arial, sans-serif" font-size="9" fill="#333">"createdAt": "2024-11-20T12:05:02Z"</text>
  <text x="160" y="1095" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="140" y="1110" font-family="Arial, sans-serif" font-size="9" fill="#333">]</text>
  
  <rect x="900" y="860" width="800" height="200" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="5"/>
  <text x="1300" y="885" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#7b1fa2">
    GET /api/notifications/unread-count/{userId}
  </text>
  <text x="1300" y="905" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt;
  </text>
  
  <rect x="920" y="920" width="760" height="60" fill="#ffffff" stroke="#7b1fa2" stroke-width="1" rx="3"/>
  <text x="940" y="940" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#7b1fa2">Response 200 OK:</text>
  <text x="940" y="960" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="960" y="975" font-family="Arial, sans-serif" font-size="9" fill="#333">"unreadCount": 3</text>
  <text x="940" y="990" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <rect x="920" y="1000" width="760" height="50" fill="#ffffff" stroke="#7b1fa2" stroke-width="1" rx="3"/>
  <text x="940" y="1020" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#7b1fa2">PUT /api/notifications/{id}/read</text>
  <text x="940" y="1040" font-family="Arial, sans-serif" font-size="9" fill="#333">Response 200 OK: { "success": true, "message": "Notification marked as read" }</text>
  
  <!-- Work Queue API -->
  <text x="900" y="1120" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Work Queue Management API
  </text>
  
  <rect x="100" y="1140" width="750" height="220" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" rx="5"/>
  <text x="475" y="1165" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2e7d32">
    GET /api/work-queues/catalog
  </text>
  <text x="475" y="1185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: SUPERVISOR, ADMIN
  </text>
  
  <rect x="120" y="1200" width="710" height="150" fill="#ffffff" stroke="#2e7d32" stroke-width="1" rx="3"/>
  <text x="140" y="1220" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2e7d32">Response 200 OK:</text>
  <text x="140" y="1240" font-family="Arial, sans-serif" font-size="9" fill="#333">[</text>
  <text x="160" y="1255" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="180" y="1270" font-family="Arial, sans-serif" font-size="9" fill="#333">"name": "PROVIDER_MANAGEMENT",</text>
  <text x="180" y="1285" font-family="Arial, sans-serif" font-size="9" fill="#333">"displayName": "Provider Management",</text>
  <text x="180" y="1300" font-family="Arial, sans-serif" font-size="9" fill="#333">"description": "Tasks related to provider onboarding, updates, and management",</text>
  <text x="180" y="1315" font-family="Arial, sans-serif" font-size="9" fill="#333">"supervisorOnly": false</text>
  <text x="160" y="1330" font-family="Arial, sans-serif" font-size="9" fill="#333">},</text>
  <text x="160" y="1345" font-family="Arial, sans-serif" font-size="9" fill="#333">...</text>
  <text x="140" y="1360" font-family="Arial, sans-serif" font-size="9" fill="#333">]</text>
  
  <rect x="900" y="1140" width="800" height="220" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" rx="5"/>
  <text x="1300" y="1165" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2e7d32">
    GET /api/work-queues/{queueName}/tasks
  </text>
  <text x="1300" y="1185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: SUPERVISOR, ADMIN
  </text>
  
  <rect x="920" y="1200" width="760" height="150" fill="#ffffff" stroke="#2e7d32" stroke-width="1" rx="3"/>
  <text x="940" y="1220" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2e7d32">Response 200 OK:</text>
  <text x="940" y="1240" font-family="Arial, sans-serif" font-size="9" fill="#333">[</text>
  <text x="960" y="1255" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="980" y="1270" font-family="Arial, sans-serif" font-size="9" fill="#333">"id": 123,</text>
  <text x="980" y="1285" font-family="Arial, sans-serif" font-size="9" fill="#333">"title": "Address Validation Required - Provider: provider1",</text>
  <text x="980" y="1300" font-family="Arial, sans-serif" font-size="9" fill="#333">"description": "Provider provider1 has changed their address to outside California - requires review",</text>
  <text x="980" y="1315" font-family="Arial, sans-serif" font-size="9" fill="#333">"status": "OPEN",</text>
  <text x="980" y="1330" font-family="Arial, sans-serif" font-size="9" fill="#333">"priority": "MEDIUM",</text>
  <text x="980" y="1345" font-family="Arial, sans-serif" font-size="9" fill="#333">"workQueue": "PROVIDER_MANAGEMENT",</text>
  <text x="980" y="1360" font-family="Arial, sans-serif" font-size="9" fill="#333">"queueRole": "CASE_WORKER",</text>
  <text x="980" y="1375" font-family="Arial, sans-serif" font-size="9" fill="#333">"assignedTo": "PROVIDER_MANAGEMENT",</text>
  <text x="980" y="1390" font-family="Arial, sans-serif" font-size="9" fill="#333">"dueDate": "2024-11-22T12:05:05Z",</text>
  <text x="980" y="1405" font-family="Arial, sans-serif" font-size="9" fill="#333">"createdAt": "2024-11-20T12:05:05Z"</text>
  <text x="960" y="1420" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="940" y="1435" font-family="Arial, sans-serif" font-size="9" fill="#333">]</text>
  
  <!-- Work Queue Subscription API -->
  <text x="900" y="1420" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Work Queue Subscription API
  </text>
  
  <rect x="100" y="1440" width="750" height="200" fill="#fff3e0" stroke="#e65100" stroke-width="2" rx="5"/>
  <text x="475" y="1465" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#e65100">
    POST /api/work-queues/subscribe
  </text>
  <text x="475" y="1485" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: SUPERVISOR, ADMIN
  </text>
  
  <rect x="120" y="1500" width="710" height="130" fill="#ffffff" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="140" y="1520" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#e65100">Request Body:</text>
  <text x="140" y="1540" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="160" y="1555" font-family="Arial, sans-serif" font-size="9" fill="#333">"username": "caseworker1",</text>
  <text x="160" y="1570" font-family="Arial, sans-serif" font-size="9" fill="#333">"workQueue": "PROVIDER_MANAGEMENT",</text>
  <text x="160" y="1585" font-family="Arial, sans-serif" font-size="9" fill="#333">"subscribedBy": "supervisor1"</text>
  <text x="140" y="1600" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="140" y="1625" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#e65100">Response 200 OK:</text>
  <text x="140" y="1645" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="160" y="1660" font-family="Arial, sans-serif" font-size="9" fill="#333">"success": true,</text>
  <text x="160" y="1675" font-family="Arial, sans-serif" font-size="9" fill="#333">"message": "User subscribed to queue successfully",</text>
  <text x="160" y="1690" font-family="Arial, sans-serif" font-size="9" fill="#333">"subscription": {</text>
  <text x="180" y="1705" font-family="Arial, sans-serif" font-size="9" fill="#333">"id": 1,</text>
  <text x="180" y="1720" font-family="Arial, sans-serif" font-size="9" fill="#333">"username": "caseworker1",</text>
  <text x="180" y="1735" font-family="Arial, sans-serif" font-size="9" fill="#333">"workQueue": "PROVIDER_MANAGEMENT",</text>
  <text x="180" y="1750" font-family="Arial, sans-serif" font-size="9" fill="#333">"subscribedBy": "supervisor1",</text>
  <text x="180" y="1765" font-family="Arial, sans-serif" font-size="9" fill="#333">"createdAt": "2024-11-20T12:10:00Z"</text>
  <text x="160" y="1780" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="140" y="1795" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <rect x="900" y="1440" width="800" height="200" fill="#fff3e0" stroke="#e65100" stroke-width="2" rx="5"/>
  <text x="1300" y="1465" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#e65100">
    GET /api/work-queues/queue/{queueName}/details
  </text>
  <text x="1300" y="1485" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: SUPERVISOR, ADMIN
  </text>
  
  <rect x="920" y="1500" width="760" height="130" fill="#ffffff" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="940" y="1520" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#e65100">Response 200 OK:</text>
  <text x="940" y="1540" font-family="Arial, sans-serif" font-size="9" fill="#333">[</text>
  <text x="960" y="1555" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="980" y="1570" font-family="Arial, sans-serif" font-size="9" fill="#333">"id": 1,</text>
  <text x="980" y="1585" font-family="Arial, sans-serif" font-size="9" fill="#333">"username": "caseworker1",</text>
  <text x="980" y="1600" font-family="Arial, sans-serif" font-size="9" fill="#333">"workQueue": "PROVIDER_MANAGEMENT",</text>
  <text x="980" y="1615" font-family="Arial, sans-serif" font-size="9" fill="#333">"subscribedBy": "supervisor1",</text>
  <text x="980" y="1630" font-family="Arial, sans-serif" font-size="9" fill="#333">"createdAt": "2024-11-20T12:10:00Z"</text>
  <text x="960" y="1645" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="940" y="1660" font-family="Arial, sans-serif" font-size="9" fill="#333">]</text>
  
  <!-- Task API -->
  <text x="900" y="1700" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Task Management API
  </text>
  
  <rect x="100" y="1720" width="750" height="200" fill="#51cf66" stroke="#2b8a3e" stroke-width="2" rx="5"/>
  <text x="475" y="1745" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2b8a3e">
    GET /api/tasks?username={username}&amp;includeSubscribedQueues=true
  </text>
  <text x="475" y="1765" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: CASE_WORKER, SUPERVISOR, ADMIN
  </text>
  
  <rect x="120" y="1780" width="710" height="130" fill="#ffffff" stroke="#2b8a3e" stroke-width="1" rx="3"/>
  <text x="140" y="1800" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2b8a3e">Query Parameters:</text>
  <text x="140" y="1820" font-family="Arial, sans-serif" font-size="9" fill="#333">• username: caseworker1 (required)</text>
  <text x="140" y="1835" font-family="Arial, sans-serif" font-size="9" fill="#333">• includeSubscribedQueues: true (optional, for caseworkers)</text>
  
  <text x="140" y="1860" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2b8a3e">Response 200 OK:</text>
  <text x="140" y="1880" font-family="Arial, sans-serif" font-size="9" fill="#333">[ Array of Task objects - same structure as work queue tasks ]</text>
  
  <rect x="900" y="1720" width="800" height="200" fill="#51cf66" stroke="#2b8a3e" stroke-width="2" rx="5"/>
  <text x="1300" y="1745" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2b8a3e">
    PUT /api/tasks/{id}/status
  </text>
  <text x="1300" y="1765" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: CASE_WORKER, SUPERVISOR, ADMIN
  </text>
  
  <rect x="920" y="1780" width="760" height="130" fill="#ffffff" stroke="#2b8a3e" stroke-width="1" rx="3"/>
  <text x="940" y="1800" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2b8a3e">Request Body:</text>
  <text x="940" y="1820" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="960" y="1835" font-family="Arial, sans-serif" font-size="9" fill="#333">"status": "IN_PROGRESS"</text>
  <text x="940" y="1850" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  
  <text x="940" y="1875" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2b8a3e">Response 200 OK:</text>
  <text x="940" y="1895" font-family="Arial, sans-serif" font-size="9" fill="#333">{ Updated Task object with new status }</text>
  
  <!-- Provider Recipient API -->
  <text x="900" y="1980" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Provider-Recipient Relationship API
  </text>
  
  <rect x="100" y="2000" width="750" height="180" fill="#339af0" stroke="#1c7ed6" stroke-width="2" rx="5"/>
  <text x="475" y="2025" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#1c7ed6">
    GET /api/provider-recipient/my-recipients
  </text>
  <text x="475" y="2045" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: PROVIDER
  </text>
  
  <rect x="120" y="2060" width="710" height="110" fill="#ffffff" stroke="#1c7ed6" stroke-width="1" rx="3"/>
  <text x="140" y="2080" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1c7ed6">Response 200 OK:</text>
  <text x="140" y="2100" font-family="Arial, sans-serif" font-size="9" fill="#333">[</text>
  <text x="160" y="2115" font-family="Arial, sans-serif" font-size="9" fill="#333">{</text>
  <text x="180" y="2130" font-family="Arial, sans-serif" font-size="9" fill="#333">"id": 1,</text>
  <text x="180" y="2145" font-family="Arial, sans-serif" font-size="9" fill="#333">"recipientName": "recipient1",</text>
  <text x="180" y="2160" font-family="Arial, sans-serif" font-size="9" fill="#333">"caseNumber": "CASE-001",</text>
  <text x="180" y="2175" font-family="Arial, sans-serif" font-size="9" fill="#333">"status": "ACTIVE",</text>
  <text x="180" y="2190" font-family="Arial, sans-serif" font-size="9" fill="#333">"authorizedHoursPerMonth": 40</text>
  <text x="160" y="2205" font-family="Arial, sans-serif" font-size="9" fill="#333">}</text>
  <text x="140" y="2220" font-family="Arial, sans-serif" font-size="9" fill="#333">]</text>
  
  <rect x="900" y="2000" width="800" height="180" fill="#339af0" stroke="#1c7ed6" stroke-width="2" rx="5"/>
  <text x="1300" y="2025" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#1c7ed6">
    GET /api/provider-recipient/my-providers
  </text>
  <text x="1300" y="2045" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Authorization: Bearer &lt;JWT_TOKEN&gt; | Role: RECIPIENT
  </text>
  
  <rect x="920" y="2060" width="760" height="110" fill="#ffffff" stroke="#1c7ed6" stroke-width="1" rx="3"/>
  <text x="940" y="2080" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1c7ed6">Response 200 OK:</text>
  <text x="940" y="2100" font-family="Arial, sans-serif" font-size="9" fill="#333">[ Array of provider relationship objects ]</text>
  
  <!-- API Flow Diagram -->
  <text x="900" y="2240" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Complete API Flow for Address Change Scenario
  </text>
  
  <rect x="100" y="2260" width="1600" height="280" fill="#ffffff" stroke="#1e3a8a" stroke-width="2" rx="5"/>
  <text x="900" y="2285" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Sequential API Calls in Address Change Flow
  </text>
  
  <rect x="120" y="2300" width="1560" height="230" fill="#f8f9fa" stroke="#1e3a8a" stroke-width="1" rx="3"/>
  <text x="140" y="2325" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">1. Authentication:</text>
  <text x="140" y="2345" font-family="Arial, sans-serif" font-size="9" fill="#333">   POST /api/auth/login → Returns JWT token</text>
  
  <text x="140" y="2370" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">2. Get Recipients (Provider):</text>
  <text x="140" y="2390" font-family="Arial, sans-serif" font-size="9" fill="#333">   GET /api/provider-recipient/my-recipients → Returns list of recipients for address change form</text>
  
  <text x="140" y="2415" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">3. Submit Address Change:</text>
  <text x="140" y="2435" font-family="Arial, sans-serif" font-size="9" fill="#333">   POST /api/cases/address-change → Creates notification, publishes Kafka event, returns success</text>
  
  <text x="140" y="2460" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">4. View Notifications (Recipient):</text>
  <text x="140" y="2480" font-family="Arial, sans-serif" font-size="9" fill="#333">   GET /api/notifications/user/recipient1 → Recipient sees address change notification</text>
  
  <text x="140" y="2505" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">5. View Work Queue (Supervisor):</text>
  <text x="140" y="2525" font-family="Arial, sans-serif" font-size="9" fill="#333">   GET /api/work-queues/PROVIDER_MANAGEMENT/tasks → Supervisor sees address validation task</text>
  
  <text x="140" y="2550" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">6. Add Caseworker to Queue (Supervisor):</text>
  <text x="140" y="2570" font-family="Arial, sans-serif" font-size="9" fill="#333">   POST /api/work-queues/subscribe → Adds caseworker1 to PROVIDER_MANAGEMENT queue</text>
  
  <text x="140" y="2595" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">7. View Tasks (Caseworker):</text>
  <text x="140" y="2615" font-family="Arial, sans-serif" font-size="9" fill="#333">   GET /api/tasks?username=caseworker1&amp;includeSubscribedQueues=true → Caseworker sees address validation task</text>
  
  <text x="140" y="2640" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e3a8a">8. Update Task Status (Caseworker):</text>
  <text x="140" y="2660" font-family="Arial, sans-serif" font-size="9" fill="#333">   PUT /api/tasks/123/status → Updates task status to IN_PROGRESS or CLOSED</text>
  
  <!-- Common Response Codes -->
  <text x="900" y="2560" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#1e3a8a">
    Standard HTTP Response Codes
  </text>
  
  <rect x="100" y="2580" width="1600" height="50" fill="#fff3e0" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="200" y="2600" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">200 OK:</text>
  <text x="280" y="2600" font-family="Arial, sans-serif" font-size="9" fill="#333">Request successful</text>
  <text x="500" y="2600" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">201 Created:</text>
  <text x="580" y="2600" font-family="Arial, sans-serif" font-size="9" fill="#333">Resource created</text>
  <text x="800" y="2600" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">400 Bad Request:</text>
  <text x="880" y="2600" font-family="Arial, sans-serif" font-size="9" fill="#333">Invalid request data</text>
  <text x="1100" y="2600" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">401 Unauthorized:</text>
  <text x="1180" y="2600" font-family="Arial, sans-serif" font-size="9" fill="#333">Missing/invalid token</text>
  <text x="1400" y="2600" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">403 Forbidden:</text>
  <text x="1480" y="2600" font-family="Arial, sans-serif" font-size="9" fill="#333">Insufficient permissions</text>
  
  <rect x="100" y="2630" width="1600" height="50" fill="#fff3e0" stroke="#e65100" stroke-width="1" rx="3"/>
  <text x="200" y="2650" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">404 Not Found:</text>
  <text x="280" y="2650" font-family="Arial, sans-serif" font-size="9" fill="#333">Resource not found</text>
  <text x="500" y="2650" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">409 Conflict:</text>
  <text x="580" y="2650" font-family="Arial, sans-serif" font-size="9" fill="#333">Resource conflict</text>
  <text x="800" y="2650" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">500 Internal Server Error:</text>
  <text x="980" y="2650" font-family="Arial, sans-serif" font-size="9" fill="#333">Server error</text>
  <text x="1200" y="2650" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">503 Service Unavailable:</text>
  <text x="1320" y="2650" font-family="Arial, sans-serif" font-size="9" fill="#333">Service temporarily unavailable</text>
  
  <!-- Arrows showing flow -->
  <path d="M 400 270 L 650 270" stroke="#1976d2" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 1050 270 L 1400 270" stroke="#2e7d32" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
  </defs>
</svg>





